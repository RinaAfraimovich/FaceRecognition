# Аннотация

Проект направлен на разработку интеллектуальной системы распознавания лиц в
школьных учреждениях на основе нейронных сетей и технологий компьютерного зрения.
Задача заключается в создании комплексной системы, повышающей уровень
безопасности и эффективности ведения учёта посещаемости посредством автоматической
идентификации посетителей.

Проведен глубокий обзор современных архитектур нейронных сетей,
используемых в задачах компьютерного зрения, а также рассмотрены различные
инструменты и методики их применения. Особое внимание уделено использованию
технологии Vibe-coding — новой парадигме программирования, в которой значительную
роль играет искусственный интеллект в создании и редактировании кода.

В ходе работы разработан программный прототип, реализующий распознавание
лиц с помощью библиотеки OpenCV и алгоритма LBPH (Local Binary Pattern Histograms).
Система настроена на работу с камерой в реальном времени, распознавая лица и
регистрируя посещаемость студентов и сотрудников.

Основное преимущество проекта заключается в автоматизации ручных процедур
учёта посещаемости, снижении рисков нарушений порядка и сокращении рабочей
нагрузки администраторов и преподавательского состава. Разработанные технические
решения и созданные механизмы являются основой для будущего расширения системы,
повышения точности распознавания

# Архитектура аппаратного комплекса
<img width="451" height="348" alt="image" src="https://github.com/user-attachments/assets/f8c608fa-b7bd-4ed0-877b-9eb5ec527a77" />

# Общая архитектура программной системы
<img width="763" height="303" alt="image" src="https://github.com/user-attachments/assets/2478dcd4-2310-4ef0-bc6d-25810f2d3f12" />

# Прототип программной системы
<img width="608" height="215" alt="image" src="https://github.com/user-attachments/assets/692a3650-d9a7-4f5a-a45a-4d59d646d861" />

#	Описание программы
Шаг 1. Импорт требуемых библиотек:
CV2 - основной модуль библиотеки OpenCV (Open Source Computer Vision Library, [https://opencv.org/]) для программирования на Python. OpenCV — библиотека с открытым исходным кодом для работы с компьютерным зрением, изначально была написана на C++, но адаптирована для использования на Python.
OS — встроенный модуль в Python, предназначенный для взаимодействия с операционной системой, [https://docs.python.org/3/library/os.html]. Он обеспечивает переносимость кода между различными платформами
Numpy - библиотека с открытым исходным кодом для языка программирования Python. Предназначена для работы с многомерными массивами и числовыми данными. 
Time — часть стандартной библиотеки языка, предоставляющую функции для работы со временем. После импорта в коде становятся доступны функции и классы модуля.
Datetime — модуль стандартной библиотеки Python, предназначенный для работы с датой и временем. Он предоставляет классы и функции для представления моментов времени, работы с интервалами, форматирования и парсинга, а также арифметических операций. 

Шаг 2. Создания основного класса FaceRecognizer:
CascadeClassifier — класс в библиотеке OpenCV, который используется для обнаружения объектов с помощью каскадного классификатора Хаара. OpenCV поставляется с несколькими предобученными каскадными классификаторами, которые можно сразу использовать без дополнительного обучения. 
haarcascade_frontalface_default.xml - файл в формате XML, который содержит предварительно обученный алгоритм Haar Cascade Classifier для обнаружения человеческих лиц. Это подход на основе машинного обучения, при котором функция каскада обучается на основе положительных и отрицательных изображений лиц (образцов с и без лиц) – этот детектор был реализован в библиотеки ОpenCV.
Признаки Хаара [https://www.sciencedirect.com/topics/mathematics/haar-system] — это признаки цифрового изображения, которые используются в распознавании образов. Они состоят из смежных прямоугольных областей. Признак Хаара позиционируется на изображении, затем суммируются интенсивности пикселей в областях, после чего вычисляется разность между суммами. Эта разность и будет значением определённого признака определённого размера, определённым образом расположенного на изображении.
Cv2.face — модуль библиотеки OpenCV, который реализует алгоритмы для обнаружения и распознавания лиц. Цель — найти лица на изображениях и сопоставить их с информацией о личности человека.
LBPH (Local Binary Patterns Histograms) — известная система распознавания лиц, которая использует дескрипторы LBP для выражения особенностей лица и гистограммы для распознавания лиц. Принцип работы: чтобы узнать, кто присутствует на фотографии, нужно натренировать модель с помощью метода train. Он принимает два параметра: массив изображений лиц и массив числовых меток для этих изображений. После этого можно вызвать метод predict на тестовом изображении (лице) и получить числовую метку, которой она соответствует.  

Шаг 3. Обучения модели train_from_folder:
Этот метод предназначен для обучения модели на основе набора изображений, расположенных в папках, каждая из которых соответствует отдельному человеку. Работа метода:
1.	Получение списка лиц: из каждой папки берём фотографии каждого человека, приводим их к одному формату (серый цвет, размер 100х100 пикселей).
2.	Формирование массива лиц и меток: для каждого обнаруженного лица присваиваем уникальный числовой ID, соответствующий имени человека.
3.	Обучение модели: Используя алгоритм LBPH, обучаем модель на полученных изображениях и соответствующих метках.
4.	Сохранение результатов: после успешного обучения модель сохраняется в файле face_model.yml, а имена пользователей записываются в словарь label_names.
Шаг 4. Метод load_model
Позволяет загрузить ранее обученную модель:
1. Проверка наличия файлов
Метод ищет файлы с моделью (face_model.yml) и списком имен (label_names.npy).
2. Возвращение модели в рабочую среду
После успешной загрузки обновляется внутреннее состояние модели (is_trained = True), и теперь можно приступать к распознаванию лиц.

Шаг 5. Метод recognize_from_camera:
Данный метод осуществляет распознавание лиц в режиме реального времени с веб-камеры.
Основные шаги метода:
1. Открытие видеокамеры и захват кадров в цикле.
2. Детектирование лиц: используется тот же самый каскадный классификатор для нахождения лиц на кадре.
3. Предсказание имени лица: Каждый найденный участок лица передаётся в распознаватель, который выдаёт метку и уровень уверенности (чем меньше значение, тем точнее распознавание).
4. Отображение результата: нарисовать рамку вокруг лица, показать имя и уровень уверенности.
5. Логирование процесса: Запись всех успешных распознаваний в файл с временными отметками.
Шаг 6. Метод main (см. Приложение):
Главная функция программы организует взаимодействие с пользователем. 
Пользователь выбирает одно из трёх действий:
1. Обучить новую модель на фотографиях.
2. Загрузить существующую модель и приступить к распознаванию.
3. Завершить программу.

